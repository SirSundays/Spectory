<div class="card">
    <form>
        <div class="form-row">
            <div class="col">
                <input type="text" class="form-control" placeholder="Search for user">
            </div>
            <div class="col">
                <a (click)="addParcel()">
                    <fa-icon [icon]="['fas', 'plus-circle']"></fa-icon>
                </a>
            </div>
        </div>
    </form>
</div>
<p *ngIf="errAfterSubmit">
    <ngb-alert [dismissible]="false">
        <p *ngFor="let error of errMessage">
            <strong>Warning!</strong> {{ error }}
        </p>
    </ngb-alert>
</p>
<table class="table table-striped">
    <thead>
        <tr>
            <th scope="col">#</th>
            <th scope="col">What?</th>
            <th scope="col">Quantity</th>
            <th scope="col">Price</th>
            <th scope="col">Receiver</th>
            <th scope="col">Purchaser</th>
            <th scope="col">State</th>
            <th scope="col" *ngIf="roles.includes('purchaser')">Action</th>
        </tr>
    </thead>
    <tbody>
        <tr *ngFor="let parcel of all_parcels; index as i" class="request-row">
            <th scope="row" (click)="showParcelDeatils(parcel._id)">{{ i + 1 }}</th>
            <td (click)="showParcelDeatils(parcel._id)">{{ parcel.name }}</td>
            <td (click)="showParcelDeatils(parcel._id)">{{ parcel.quantity | number }}</td>
            <td (click)="showParcelDeatils(parcel._id)">{{ parcel.price | number }}</td>
            <td (click)="showParcelDeatils(parcel._id)">{{ parcel.receiver.firstName }} {{parcel.receiver.lastName }}</td>
            <td (click)="showParcelDeatils(parcel._id)">{{ parcel.purchaser.firstName }} {{parcel.purchaser.lastName }}</td>
            <td (click)="showParcelDeatils(parcel._id)">
                <span class="badge badge-primary" *ngIf="parcel.state == 'requested'">requested</span>
                <span class="badge badge-success" *ngIf="parcel.state == 'accept'">accepted</span>
                <span class="badge badge-info" *ngIf="parcel.state == 'allocated'">allocated</span>
                <span class="badge badge-light" *ngIf="parcel.state == 'ordered'">ordered</span>
                <span class="badge badge-danger" *ngIf="parcel.state == 'decline'">declined</span>
                <span class="badge badge-secondary" *ngIf="parcel.state == 'archived'">archived</span>
            </td>
            <td>
                <button type="button" class="btn btn-dark" *ngIf="roles.includes('purchaser') && parcel.state == 'allocated' && parcel.purchaser.email == myMail" (click)="parcelOrdered(parcel._id, parcel.name)">Ordered</button>
            </td>
        </tr>
    </tbody>
</table>